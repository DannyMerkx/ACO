N=11;
dag = zeros(N,N);

varNames= {'Akt','Erk','Jnk','Mek','P38','PIP2','PIP3','PKA','PKC','Plcg','Raf'};

for i=1:N
    eval([varNames{i} '= i;']);    
end

parents = {{'Akt','Erk'},{'Akt','PKA'},{'Erk','Mek'},{'Erk','PKA'},{'Jnk','PKA'},...
    {'Jnk','PKC'},{'Mek','PKA'},{'Mek','PKC'},{'Mek','Raf'},{'P38','PKA'},{'P38','PKC'},...
    {'PIP2','PIP3'},{'PIP2','Plcg'},{'PIP3','Plcg'},{'PKA','PKC'},{'Raf','PKA'},{'Raf','PKC'}};

for i=1:size (parents,2)
    dag(eval(parents{i}{2}),eval(parents{i}{1}))=1;
end

discrete_nodes = 1:N;
node_sizes = [3,3,3,3,3,3,3,3,3,3,3];

bnet = mk_bnet(dag, node_sizes);

 x=[0.6722222, 0.3277778, 0.0000000
 0.3349515, 0.6650485, 0.0000000
 0.0000000, 0.1182573, 0.8817427
   0.6204819, 0.3795181, 0.0000000
  0.8214285714, 0.1781954887, 0.0003759398
   0.177083333, 0.813802083, 0.009114583
  0.97674419, 0.02325581, 0.00000000
   0.94852941, 0.05147059, 0.00000000
 0.1702128, 0.8297872, 0.0000000];

bnet.CPD{eval('Akt')}= tabular_CPD(bnet, eval('Akt'), [x(:,1),x(:,2),x(:,3)]);


  x=[0.85066667, 0.13866667, 0.01066667
  0.3870968, 0.4838710, 0.1290323
   0.00862069, 0.18793103, 0.80344828
   0.1177011, 0.6919540, 0.1903448
  0.04893754, 0.72826787, 0.22279459
   0.00, 0.75, 0.25
  0.07401033, 0.70051635, 0.22547332
   0.0, 0.1, 0.9
   0.0, 0.0, 1.0];

bnet.CPD{eval('Erk')}= tabular_CPD(bnet, eval('Erk'), [x(:,1),x(:,2),x(:,3)]);


  x=[0.2899207, 0.2457531, 0.4643262
   0.5767013, 0.4232987, 0.0000000
  0.996261682, 0.003738318, 0.000000000
   0.5796178, 0.4203822, 0.0000000
   0.6129167, 0.3870833, 0.0000000
 0.8636364, 0.1363636, 0.0000000
0.0, 1.0, 0.0
  0.04462475, 0.93509128, 0.02028398
   0.1538462, 0.8461538, 0.0000000];

bnet.CPD{eval('Jnk')}= tabular_CPD(bnet, eval('Jnk'), [x(:,1),x(:,2),x(:,3)]);


 x=[ 0.7454545, 0.2545455, 0.0000000
   0.757732, 0.242268, 0.000000
  0.997782705, 0.002217295, 0.000000000
  0.7068966, 0.2931034, 0.0000000
  0.714826, 0.285174, 0.000000
  0.96969697, 0.03030303, 0.00000000
   0.8571429, 0.1428571, 0.0000000
   0.8256881, 0.1743119, 0.0000000
   0.7272727, 0.2727273, 0.0000000
   0.3846154, 0.1230769, 0.4923077
  0.343173432, 0.649446494, 0.007380074
 1.0, 0.0, 0.0
   0.2692308, 0.7307692, 0.0000000
   0.274655355, 0.720042418, 0.005302227
 0.8571429, 0.1428571, 0.0000000
  0.0, 1.0, 0.0
  0.1052632, 0.8947368, 0.0000000
   0.0, 1.0, 0.0
   0.262177650, 0.001432665, 0.736389685
  0.86538462, 0.10096154, 0.03365385
   0.9375, 0.0000, 0.0625
   0.85106383, 0.10638298, 0.04255319
  0.2814815, 0.5851852, 0.1333333
  0.5, 0.5, 0.0
   0.3333333, 0.3333333, 0.3333333
  0.3333333, 0.3333333, 0.3333333
  0.3333333, 0.3333333, 0.3333333];

bnet.CPD{eval('Mek')}= tabular_CPD(bnet, eval('Mek'), [x(:,1),x(:,2),x(:,3)]);

  x=[ 0.30690827, 0.06455266, 0.62853907
 0.919261822, 0.078431373, 0.002306805
   0.80747664, 0.09158879, 0.10093458
  0.656051, 0.343949, 0.000000
   0.815, 0.185, 0.000
   0.3863636, 0.1590909, 0.4545455
   0.875, 0.125, 0.000
   0.803245436, 0.192697769, 0.004056795
   0.7692308, 0.2307692, 0.0000000];


bnet.CPD{eval('P38')}= tabular_CPD(bnet, eval('P38'), [x(:,1),x(:,2),x(:,3)]);

x=[ 0.996868476, 0.003131524, 0.000000000
  0.98674822, 0.01325178, 0.00000000
   0.872442019, 0.120054570, 0.007503411
   1.0, 0.0, 0.0
   0.95789474, 0.04210526, 0.00000000
   0.521875, 0.462500, 0.015625
   0.2217573, 0.4937238, 0.2845188
   0.0766129, 0.3911290, 0.5322581
 0.02597403, 0.05194805, 0.92207792];

bnet.CPD{eval('PIP2')}= tabular_CPD(bnet, eval('PIP2'), [x(:,1),x(:,2),x(:,3)]);

x=[  0.2184223, 0.4473324, 0.3342453
 0.07777778, 0.21111111, 0.71111111
   0.4237589, 0.4397163, 0.1365248];

bnet.CPD{eval('PIP3')}= tabular_CPD(bnet, eval('PIP3'), [x(:,1),x(:,2),x(:,3)]);


  x=[0.3864333, 0.3794311, 0.2341357
   0.06036140, 0.92272203, 0.01691657
  0.01556420, 0.95914397, 0.02529183];

bnet.CPD{eval('PKA')}= tabular_CPD(bnet, eval('PKA'), [x(:,1),x(:,2),x(:,3)]);

 x=[  0.42314815, 0.48166667, 0.09518519];

bnet.CPD{eval('PKC')}= tabular_CPD(bnet, eval('PKC'), [x(:,1),x(:,2),x(:,3)]);

x=[   0.81222222, 0.08333333, 0.10444444];

bnet.CPD{eval('Plcg')}= tabular_CPD(bnet, eval('Plcg'), [x(:,1),x(:,2),x(:,3)]);

x=[ 0.06228766, 0.14722537, 0.79048698
 0.4475202, 0.3125721, 0.2399077
   0.84299065, 0.12710280, 0.02990654
   0.3694268, 0.3312102, 0.2993631
   0.5508333, 0.3929167, 0.0562500
  0.75000000, 0.15909091, 0.09090909
  0.875, 0.125, 0.000
  0.8843813, 0.1156187, 0.0000000
   0.8461538, 0.1538462, 0.0000000];

bnet.CPD{eval('Raf')}= tabular_CPD(bnet, eval('Raf'), [x(:,1),x(:,2),x(:,3)]);

for i=1:10000
    data(i,:)= cell2mat(sample_bnet(bnet))';
end
